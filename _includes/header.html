<header class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="{{ "/" | relative_url }}">{{ site.title | escape }}</a>
    {% if site.ai_generated_filter %}
    <div class="ai-filter">
      <label>
        <input type="checkbox" id="hideAiContent" onchange="toggleAiContent()">
        Hide AI generated content
      </label>
    </div>
    {% endif %}
  </div>
</header>

<style>
.ai-filter {
  float: right;
  margin-top: 10px;
}
.ai-filter label {
  display: flex;
  align-items: center;
  gap: 5px;
  cursor: pointer;
}
</style>

<script>
// Initialize checkbox state from localStorage
document.addEventListener('DOMContentLoaded', function() {
  const checkbox = document.getElementById('hideAiContent');
  if (checkbox) {
    const savedState = localStorage.getItem('hideAiContent');
    const hideAi = savedState === 'true';
    checkbox.checked = hideAi;
    if (hideAi) {
      toggleAiContent(); // Apply the true state immediately
    }
  }
});

function toggleAiContent() {
  const checkbox = document.getElementById('hideAiContent');
  if (!checkbox) return;
  
  const hideAi = checkbox.checked;
  // Save or remove state from localStorage
  if (hideAi) {
    localStorage.setItem('hideAiContent', 'true');
  } else {
    localStorage.removeItem('hideAiContent');
  }
  
  const aiPosts = document.querySelectorAll('.post-list li.ai-generated');
  aiPosts.forEach(post => {
    post.style.display = hideAi ? 'none' : 'block';
  });
}
</script>
