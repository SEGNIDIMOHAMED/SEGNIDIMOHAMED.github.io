---
layout: post
title: test ipython with markdown
---

```python
#import data to data frame and show data 
import pandas as pd
Student= pd.read_csv(r"C:\Users\Wenlei\Documents\text_files\student.txt", sep="\t")  # please change directory and sep accordingly 
Student.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>



## DML


```python
#DML operation
#select * from student
Student
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#select top 2 * from student
Student[:2]  #Student.head(2)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
  </tbody>
</table>
</div>




```python
#select * from student where studentid =3
Student.query('Studentid == 3')  #intuitive for database 

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
  </tbody>
</table>
</div>




```python
#multiple conditions select * from student where studentid >2 and Studentname = 'Adam'
Student.query('Studentid > 2 and StudentName == "Adam"')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
  </tbody>
</table>
</div>




```python
#OR logic operation  select * from student where studentid >2 or Studentname = 'Adam'
Student.query('Studentid > 2 or StudentName == "Adam"')

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#not logic operation select * from student where studentid >2 and not( Studentname = 'Adam')
Student.query('Studentid > 2 and not(StudentName == "Adam")')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#wild card  select * from student where studentname like '%a%'   find student name contain a
Student.query('StudentName.str.contains("a")', engine='python')

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
  </tbody>
</table>
</div>




```python
#wild card  select * from student where studentname like 'a%'   find student name start with a
Student.query('StudentName.str.lower().str.startswith("a")', engine='python')  #notice here I use lower() function to ignore case
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
  </tbody>
</table>
</div>




```python
# condition in a list  select * from student where studentname in ('Mary', 'Terry')
# https://stackoverflow.com/questions/19960077/how-to-filter-pandas-dataframe-using-in-and-not-in-like-in-sql
Student.query ('StudentName in (["Mary", "Terry"])')

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
# condition not in a list  select * from student where studentname in ('Mary', 'Terry')
# https://stackoverflow.com/questions/33990955/combine-pandas-dataframe-query-method-with-isin
Student.query ('StudentName not in (["Mary", "Terry"])')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
  </tbody>
</table>
</div>



#null selection,  select * from student where studentname is not null
https://stackoverflow.com/questions/37863660/pandas-dataframe-query-fetch-not-null-rows-pandas-equivalent-to-sql-is-no



```python
#select only part of columns  select studentName from student
# the following post has a good summary on use .loc and i.loc
###https://medium.com/dunder-data/selecting-subsets-of-data-in-pandas-6fcd0170be9c

Student[['StudentName']]      #it has to be a list, imaging you have more than 2 column 

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#project a new column, select *, cast(studentid as varchar(3)) + '_' + StudentName as StudentName2 from student
#https://stackoverflow.com/questions/34283234/concatenate-index-and-string-to-new-column
Student['StudentName2'] = Student['Studentid'].astype(str) + "_" + Student['StudentName']
Student

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
      <th>StudentName2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>1_John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
      <td>2_Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
      <td>3_Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
      <td>4_Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#drop a column
Student= Student.drop(['StudentName2'], axis=1)   #replace the old dataframe
Student

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#insert data  https://pythonexamples.org/pandas-dataframe-add-append-row/
# insert into student values (5, 'George')
#create a dictionary
new_row = {'Studentid': 5, 'StudentName':'George'}
Student = Student.append(new_row, ignore_index=True)
Student
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>George</td>
    </tr>
  </tbody>
</table>
</div>




```python
#update a row   # update student set StudentName = 'Lisa' where studentid =5
#https://stackoverflow.com/questions/24036911/how-to-update-values-in-a-specific-row-in-a-python-pandas-dataframe
#Student.loc[Student.Studentid==5, Student.StudentName] = 'Lisa'
#Student
Student.loc[Student.Studentid==5, 'StudentName'] ='Lisa'   #use row and column index to locate George and replace the value
Student
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Lisa</td>
    </tr>
  </tbody>
</table>
</div>




```python
#delete a row   delete from student where studentid =5
Student = Student.loc[Student.Studentid!=5]
Student

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#order by   select * from student order by studentname
Student.sort_values('StudentName')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
  </tbody>
</table>
</div>




```python
#order by descend  select * from student order by studentname desc
Student.sort_values('StudentName', ascending=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
  </tbody>
</table>
</div>



#select distinct column or row
https://riptutorial.com/pandas/example/26077/select-distinct-rows-across-dataframe


```python
#join two dataset 
#import additional table 1
Course= pd.read_csv(r"C:\Users\Wenlei\Documents\text_files\course.txt", sep="\t")
Course
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Courseid</th>
      <th>Course</th>
      <th>Tuition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>English</td>
      <td>200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>Big Data</td>
      <td>600</td>
    </tr>
    <tr>
      <th>2</th>
      <td>c</td>
      <td>Business</td>
      <td>400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>d</td>
      <td>Biology</td>
      <td>300</td>
    </tr>
  </tbody>
</table>
</div>




```python
#becasue course table is many to many relation with student table, so need a bridge table
StudentCourse= pd.read_csv(r"C:\Users\Wenlei\Documents\text_files\studentcourse.txt", sep="\t")
StudentCourse
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>Courseid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>d</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>a</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>c</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4</td>
      <td>b</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4</td>
      <td>c</td>
    </tr>
  </tbody>
</table>
</div>




```python
#let us see how we join three table together to get some useful info
#use inner join
fulldata1 = pd.merge(Student, StudentCourse, how='inner', on='Studentid')  #first join student with studentcourse
fulldata = pd.merge(fulldata1, Course, how='inner', on='Courseid')
fulldata
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
      <th>Courseid</th>
      <th>Course</th>
      <th>Tuition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>a</td>
      <td>English</td>
      <td>200</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>Adam</td>
      <td>a</td>
      <td>English</td>
      <td>200</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>John</td>
      <td>b</td>
      <td>Big Data</td>
      <td>600</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
      <td>b</td>
      <td>Big Data</td>
      <td>600</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>Mary</td>
      <td>d</td>
      <td>Biology</td>
      <td>300</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3</td>
      <td>Adam</td>
      <td>c</td>
      <td>Business</td>
      <td>400</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4</td>
      <td>Terry</td>
      <td>c</td>
      <td>Business</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
# to see left join effect, i will manually add a student to student table 
new_row = {'Studentid': 5, 'StudentName':'George'}
Student = Student.append(new_row, ignore_index=True)
print (Student)
#left join to see effect, George has no value on the course side 
fulldata1 = pd.merge(Student, StudentCourse, how='left', on='Studentid')  #first join student with studentcourse
fulldata = pd.merge(fulldata1, Course, how='left', on='Courseid')
fulldata
```

       Studentid StudentName
    0          1        John
    1          2        Mary
    2          3        Adam
    3          4       Terry
    4          5      George
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
      <th>Courseid</th>
      <th>Course</th>
      <th>Tuition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
      <td>a</td>
      <td>English</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>John</td>
      <td>b</td>
      <td>Big Data</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Mary</td>
      <td>d</td>
      <td>Biology</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Adam</td>
      <td>a</td>
      <td>English</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>Adam</td>
      <td>c</td>
      <td>Business</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4</td>
      <td>Terry</td>
      <td>b</td>
      <td>Big Data</td>
      <td>600.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4</td>
      <td>Terry</td>
      <td>c</td>
      <td>Business</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5</td>
      <td>George</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
#check set operation, manually create a dataframe call Student2
import numpy as np
Student2= pd.DataFrame(np.array([
    #[1, 'John'],
    Student.iloc[0],   #replicate this from Student
    [6, 'Katie'],
    [7, 'Joe']]),
    columns=['Studentid', 'StudentName'])
Student2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>Katie</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>Joe</td>
    </tr>
  </tbody>
</table>
</div>




```python
#test union and union all with the newly create dataset, I intentionally include john and different name
#select * from student union (all) select * from student2
Student_unionall = pd.concat([Student, Student2],ignore_index=True)  #ignore_index will reset 2nd dataframe index 
Student_unionall
#you can see John appear twice
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>George</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>Katie</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>Joe</td>
    </tr>
  </tbody>
</table>
</div>




```python
# test union
Student_union = pd.concat([Student, Student2],ignore_index=True).drop_duplicates()  #ignore_index will reset 2nd dataframe index 
Student_union
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>George</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>Katie</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>Joe</td>
    </tr>
  </tbody>
</table>
</div>




```python
#test intersect
Student_insersect = pd.merge(Student, Student2)
Student_insersect
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>John</td>
    </tr>
  </tbody>
</table>
</div>




```python
#test except or minus   setdiff = original dataset - intersect 
#https://stackoverflow.com/questions/33990955/combine-pandas-dataframe-query-method-with-isin
except_list = list(Student_insersect.StudentName)
Student_except =Student.query ('StudentName != @except_list')
Student_except
#except_list
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Studentid</th>
      <th>StudentName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Mary</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Adam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Terry</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>George</td>
    </tr>
  </tbody>
</table>
</div>



## Analytics 


```python

```

